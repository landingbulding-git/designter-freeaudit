---
import Layout from '../../layouts/Layout.astro';
import { getPublishedBlogPosts } from '../../lib/notion';
import { Image } from 'astro:assets';

const posts = (await getPublishedBlogPosts()).sort((a, b) => 
  new Date(b.publishedDate).getTime() - new Date(a.publishedDate).getTime()
);

const title = "DesignTér Blog - Weboldal Készítés & Audit Tippek";
const description = "Olvass szakmai cikkeket weboldal készítésről, UX designról és konverzió optimalizálásról.";
---

<Layout title={title} description={description}>
  <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-sm border-b border-gray-100 py-4">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
      <a href="/" class="flex items-center gap-2 group">
        <div class="bg-[#ea580c] p-2 rounded-lg group-hover:bg-[#c2410c] transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><path d="m22 14-5 5-5-5"/><path d="M17 19V3"/></svg>
        </div>
        <span class="text-xl font-bold tracking-tight text-[#1e293b]">DesignTér</span>
      </a>
      <a 
        href="/ingyenes-audit"
        class="bg-[#ea580c] hover:bg-[#c2410c] text-white font-semibold py-2 px-6 rounded-full transition-colors duration-200 text-sm md:text-base"
      >
        Ingyenes Audit
      </a>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-20">
    <div class="text-center mb-16">
      <h1 class="text-4xl md:text-5xl font-extrabold text-[#1e293b] mb-4">
        Szakmai Tudástár
      </h1>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">
        Gyakorlati tanácsok, elemzések és útmutatók a hatékonyabb webes jelenléthez.
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {posts.map((post) => (
        <article class="bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-md transition-shadow duration-300 border border-gray-100 flex flex-col h-full">
          <a href={`/blog/${post.slug}`} class="block aspect-video overflow-hidden">
            {post.coverImage ? (
              <Image 
                src={post.coverImage} 
                alt={post.title}
                width={800}
                height={450}
                class="w-full h-full object-cover hover:scale-105 transition-transform duration-500"
              />
            ) : (
              <div class="w-full h-full bg-gray-100 flex items-center justify-center text-gray-400">
                <span class="sr-only">Nincs borítókép</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>
              </div>
            )}
          </a>
          <div class="p-6 flex flex-col flex-grow">
            <div class="flex items-center gap-4 text-sm text-gray-500 mb-3">
              <time datetime={post.publishedDate.toISOString()}>
                {post.publishedDate.toLocaleDateString('hu-HU', { 
                  year: 'numeric', 
                  month: 'long', 
                  day: 'numeric' 
                })}
              </time>
            </div>
            <h2 class="text-xl font-bold text-[#1e293b] mb-3 line-clamp-2 hover:text-[#ea580c] transition-colors">
              <a href={`/blog/${post.slug}`}>
                {post.title}
              </a>
            </h2>
            <p class="text-gray-600 mb-4 line-clamp-3 flex-grow">
              {post.description}
            </p>
            <a 
              href={`/blog/${post.slug}`}
              class="inline-flex items-center font-semibold text-[#ea580c] hover:text-[#c2410c] mt-auto"
            >
              Olvass tovább
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-2"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
            </a>
          </div>
        </article>
      ))}
    </div>
  </main>
</Layout>
